# Console RAG: –ö–æ–Ω—Å–æ–ª—å–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ö–æ–Ω—Å–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–æ–≤ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —ç—Ç–∞–ª–æ–Ω–Ω–æ–º—É (–æ—Å–Ω–æ–≤–Ω–æ–º—É) –¥–æ–∫—É–º–µ–Ω—Ç—É —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º RAG (Retrieval-Augmented Generation).

**–û—Å–Ω–æ–≤–Ω–æ–π use case**: –ê–Ω–∞–ª–∏–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –∞–∫—Ç–æ–≤ (–õ–ù–ê) —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¢—Ä—É–¥–æ–≤–æ–º—É –∫–æ–¥–µ–∫—Å—É –†–§.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
1. **–í–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î**: chromem-go –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
2. **–≠–º–±–µ–¥–¥–∏–Ω–≥–∏**: Ollama (nomic-embed-text)
3. **LLM**: Ollama (gemma3:12b)
4. **–ß–∞–Ω–∫–∏–Ω–≥**: goldmark –¥–ª—è Markdown, –ø—Ä–æ—Å—Ç–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –¥–ª—è TXT
5. **PDF**: github.com/ledongthuc/pdf
6. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ + —Ñ–ª–∞–≥–∏ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

### Workflow:
1. **–ó–∞–ø—É—Å–∫**: `console_rag --reference-doc=/path/to/main_document.md`
2. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**: 
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ë–î (–∏–º—è = `<–∏–º—è_–¥–æ–∫—É–º–µ–Ω—Ç–∞>.gob`)
   - –ï—Å–ª–∏ –ë–î –Ω–µ—Ç: —á–∏—Ç–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç ‚Üí —á–∞–Ω–∫—É–µ–º ‚Üí –≤–µ–∫—Ç–æ—Ä–∏–∑—É–µ–º ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ–º —á–µ—Ä–µ–∑ `ExportToFile()`
   - –ï—Å–ª–∏ –ë–î –µ—Å—Ç—å: –∑–∞–≥—Ä—É–∂–∞–µ–º —á–µ—Ä–µ–∑ `ImportFromFile()`
3. **–ö–æ–Ω—Å–æ–ª—å–Ω—ã–π —Ä–µ–∂–∏–º**: –û–∂–∏–¥–∞–µ–º –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫ (stdin)
4. **–î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏**:
   - –í–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ–º —Å—Ç—Ä–æ–∫—É –∫–∞–∫ —Ç–µ–∫—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
   - –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —á–∞–Ω–∫–∏ (–µ—Å–ª–∏ –¥–ª–∏–Ω–Ω–∞—è) –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ü–µ–ª–∏–∫–æ–º
   - –ò—â–µ–º —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —á–∞—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç + —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —á–∞—Å—Ç–∏ –≤ LLM –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
   - –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∫–æ–Ω—Å–æ–ª—å
5. **–í—ã—Ö–æ–¥**: Ctrl+C –∏–ª–∏ EOF

---

## –¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
console_rag/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ console_rag/
‚îÇ       ‚îî‚îÄ‚îÄ main.go           # ‚úÖ –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥–∞, –∑–∞–ø—É—Å–∫
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config.go         # ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ env
‚îÇ   ‚îî‚îÄ‚îÄ app/
‚îÇ       ‚îú‚îÄ‚îÄ app.go            # ‚úÖ –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞, Init()
‚îÇ       ‚îú‚îÄ‚îÄ run.go            # ‚úÖ –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–∑–∞–≥–ª—É—à–∫–∞)
‚îÇ       ‚îî‚îÄ‚îÄ index.go          # ‚ö†Ô∏è  –ó–∞–≥–ª—É—à–∫–∏ fileCanProcess, fileGetContent
‚îú‚îÄ‚îÄ go.mod                    # ‚úÖ –ë–∞–∑–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ CONTEXT.md                # üìÑ –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

### –ß—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ env
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è chromem-go –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Ollama
- ‚úÖ –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤–≤–æ–¥ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π Ctrl+C
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ –ë–î —á–µ—Ä–µ–∑ ExportToFile/ImportFromFile

---

## –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–ø–æ—à–∞–≥–æ–≤—ã–π)

–ö–∞–∂–¥—ã–π —à–∞–≥ –¥–æ–ª–∂–µ–Ω –¥–∞–≤–∞—Ç—å **–∑–∞–ø—É—Å–∫–∞–µ–º–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**.

---

### **–®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å —Ñ–ª–∞–≥ --reference-doc –∏ –æ–±–Ω–æ–≤–∏—Ç—å Config**

**–¶–µ–ª—å**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø—É—Ç—å –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É –¥–æ–∫—É–º–µ–Ω—Ç—É —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:

1. **–û–±–Ω–æ–≤–∏—Ç—å `internal/config/config.go`**:
   - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è: `ReferenceDoc`, `ChunkSize`, `ChunkOverlap`
   - –£–±—Ä–∞—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è: `DocsDir`, `Port`, `DevMode`, `ForceReindex`

2. **–û–±–Ω–æ–≤–∏—Ç—å `cmd/console_rag/main.go`**:
   - –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ —Ñ–ª–∞–≥–∞ `--reference-doc` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
   - –í—ã—á–∏—Å–ª–∏—Ç—å –ø—É—Ç–∏ –∫ –ë–î –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–º–µ–Ω–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞: `<document_name>.gob` –∏ `<document_name>_metadata.json`
   - –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `./data` –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å —Ñ–ª–∞–≥–æ–º `--reference-doc`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞.

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```bash
# –ë–µ–∑ —Ñ–ª–∞–≥–∞ - –æ—à–∏–±–∫–∞
go run cmd/console_rag/main.go
# Error: --reference-doc flag is required

# –° –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ñ–∞–π–ª–æ–º - –æ—à–∏–±–∫–∞
go run cmd/console_rag/main.go --reference-doc=nonexistent.md
# Error: reference document not found

# –° —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ñ–∞–π–ª–æ–º - –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
echo "# Test" > test.md
go run cmd/console_rag/main.go --reference-doc=test.md
# Application started
```

---

### **–®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–æ–∑–¥–∞—Ç—å chunker**

**–¶–µ–ª—å**: –î–æ–±–∞–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PDF –∏ Markdown, —Å–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–∑–±–∏–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:

1. **–î–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
```bash
go get github.com/yuin/goldmark@v1.7.0
go get github.com/ledongthuc/pdf@latest
go mod tidy
```

2. **–°–æ–∑–¥–∞—Ç—å `internal/app/chunker.go`**:
   - –¢–∏–ø `Chunk` —Å –ø–æ–ª—è–º–∏: `ID`, `Text`, `Source`, `Section`
   - –¢–∏–ø `Chunker` —Å –º–µ—Ç–æ–¥–∞–º–∏:
     - `ChunkMarkdown(content, source string) []Chunk` - —Ä–∞–∑–±–∏–µ–Ω–∏–µ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º
     - `ChunkText(content, source string) []Chunk` - —Ä–∞–∑–±–∏–µ–Ω–∏–µ –ø–æ —Ä–∞–∑–º–µ—Ä—É —Å overlap
     - `createChunk()` - —Å–æ–∑–¥–∞–Ω–∏–µ —á–∞–Ω–∫–∞ —Å ID (sha256 hash)

3. **–û–±–Ω–æ–≤–∏—Ç—å `internal/app/app.go`**:
   - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `chunker *Chunker` –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É `App`
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤ `New()`: `chunker: NewChunker(cfg.ChunkSize, cfg.ChunkOverlap)`

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è, chunker –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```bash
go build cmd/console_rag/main.go
# –î–æ–ª–∂–Ω–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
```

---

### **–®–∞–≥ 3: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ —Ñ–∞–π–ª–æ–≤**

**–¶–µ–ª—å**: –§—É–Ω–∫—Ü–∏–∏ `fileCanProcess` –∏ `fileGetContent` —Ä–∞–±–æ—Ç–∞—é—Ç —Å TXT, PDF, MD.

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `internal/app/index.go`**:

1. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `fileCanProcess(path string) bool`**:
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è: `.md`, `.txt`, `.pdf`

2. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `fileGetContent(path string) (string, error)`**:
   - –î–ª—è `.md` –∏ `.txt`: `os.ReadFile()`
   - –î–ª—è `.pdf`: –≤—ã–∑–æ–≤ `extractPDFText()`

3. **–î–æ–±–∞–≤–∏—Ç—å `extractPDFText(path string) (string, error)`**:
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `github.com/ledongthuc/pdf`
   - –ò–∑–≤–ª–µ—á—å —Ç–µ–∫—Å—Ç —Å–æ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
   - –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª—ã —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤.

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```bash
# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã
echo "–¢–µ—Å—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç" > test.txt
echo "# –ó–∞–≥–æ–ª–æ–≤–æ–∫\n–¢–µ–∫—Å—Ç" > test.md

go run cmd/console_rag/main.go --reference-doc=test.md
# –î–æ–ª–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
```

---

### **–®–∞–≥ 4: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞**

**–¶–µ–ª—å**: –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç—Å—è –≤ –≤–µ–∫—Ç–æ—Ä–Ω—É—é –ë–î (–µ—Å–ª–∏ –ë–î –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç).

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `internal/app/app.go`**:

1. **–û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–æ–¥ `Init()`**:
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –ë–î (`cfg.DBFile`)
   - –ï—Å–ª–∏ –ë–î —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: –∑–∞–≥—Ä—É–∑–∏—Ç—å —á–µ—Ä–µ–∑ `loadDB()`
   - –ï—Å–ª–∏ –ë–î –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: –≤—ã–∑–≤–∞—Ç—å `indexReferenceDocument()`

2. **–°–æ–∑–¥–∞—Ç—å –º–µ—Ç–æ–¥ `indexReferenceDocument() error`**:
   - –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª —á–µ—Ä–µ–∑ `fileGetContent(cfg.ReferenceDoc)`
   - –†–∞–∑–±–∏—Ç—å –Ω–∞ —á–∞–Ω–∫–∏ (Markdown –∏–ª–∏ Text –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
   - –°–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é "docs" –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
   - –î–æ–±–∞–≤–∏—Ç—å —á–∞–Ω–∫–∏ –≤ –ë–î —á–µ—Ä–µ–∑ `coll.AddDocuments()`
   - –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ë–î —á–µ—Ä–µ–∑ `saveDB()`
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ `saveMetadata()`

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –æ—Å–Ω–æ–≤–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç—Å—è, –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö - –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –ë–î.

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```bash
# –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
go run cmd/console_rag/main.go --reference-doc=test.md
# Indexing reference document...
# Reference document split into X chunks
# Reference document indexed successfully

# –í—Ç–æ—Ä–æ–π –∑–∞–ø—É—Å–∫
go run cmd/console_rag/main.go --reference-doc=test.md
# Loading existing DB...
# Reference document ready
```

---

### **–®–∞–≥ 5: –ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å–Ω—ã–π —Ä–µ–∂–∏–º**

**–¶–µ–ª—å**: –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–∞–∫ **—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–µ–∫—Å—Ç–∞** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –∞ –Ω–µ –∫–∞–∫ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º.

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `internal/app/run.go`**:

1. **–û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–æ–¥ `Run()`**:
   - –ò–∑–º–µ–Ω–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ: "Enter text to check (one per line)"
   - –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Å—Ç—Ä–æ–∫—É –≤ `handleInput(text string)` –≤–º–µ—Å—Ç–æ `handleFile(path string)`

2. **–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –∏ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å `handleFile()` ‚Üí `handleInput(text string)`**:
   - –£–±—Ä–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `os.Stat()` - —Å—Ç—Ä–æ–∫–∞ —ç—Ç–æ –Ω–µ –ø—É—Ç—å!
   - –£–±—Ä–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `fileCanProcess()` - —Ç–µ–∫—Å—Ç —É–∂–µ –≥–æ—Ç–æ–≤
   - –†–∞–∑–±–∏—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ —á–∞–Ω–∫–∏ (–µ—Å–ª–∏ –¥–ª–∏–Ω–Ω—ã–π) –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ü–µ–ª–∏–∫–æ–º
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞–Ω–∫–∞: –ø–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞—Å—Ç–µ–π –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
   - –í—ã–≤–µ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å similarity scores

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç, –ø–æ–ª—É—á–∞–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞.

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```bash
go run cmd/console_rag/main.go --reference-doc=test.md

> –†–∞–±–æ—Ç–Ω–∏–∫ –æ–±—è–∑–∞–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è
# ‚úÖ Found 3 relevant sections from reference document
# 1. –°—Ç–∞—Ç—å—è 21. –û—Å–Ω–æ–≤–Ω—ã–µ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç–Ω–∏–∫–∞ (similarity: 0.85)
# 2. –°—Ç–∞—Ç—å—è 56. –¢—Ä—É–¥–æ–≤–æ–π –¥–æ–≥–æ–≤–æ—Ä (similarity: 0.72)
```

---

### **–®–∞–≥ 6: –î–æ–±–∞–≤–∏—Ç—å RAG-–ø–∞–π–ø–ª–∞–π–Ω**

**–¶–µ–ª—å**: –î–ª—è –∫–∞–∂–¥–æ–π –≤—Ö–æ–¥—è—â–µ–π —Å—Ç—Ä–æ–∫–∏ –∏—Å–∫–∞—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —á–∞—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î.

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `internal/app/run.go`**:

1. **–í –º–µ—Ç–æ–¥–µ `handleInput()`**:
   - –ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é: `coll := a.db.GetCollection("docs", a.embeddingFunc)`
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞–Ω–∫–∞ –≤—Ö–æ–¥—è—â–µ–≥–æ —Ç–µ–∫—Å—Ç–∞:
     - –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–∏—Å–∫: `results, err := coll.Query(ctx, chunk.Text, 3, nil, nil)`
     - –í—ã–≤–µ—Å—Ç–∏ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ (section, similarity)

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í–∏–¥–∏–º —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —á–∞—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ —Å –æ—Ü–µ–Ω–∫–æ–π similarity.

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```bash
go run cmd/console_rag/main.go --reference-doc=test.md

> –¢–µ—Å—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
# üîç Searching for relevant sections...
# ‚úÖ Found 3 relevant sections:
#   1. [Section: –ó–∞–≥–æ–ª–æ–≤–æ–∫ 1] (similarity: 0.89)
#      Preview: –¢–µ–∫—Å—Ç –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞...
```

---

### **–®–∞–≥ 7: –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Ollama LLM**

**–¶–µ–ª—å**: –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∞–Ω–∞–ª–∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —á–µ—Ä–µ–∑ LLM –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ –≤—ã–≤–æ–¥–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Å–µ–∫—Ü–∏–π.

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:

1. **–°–æ–∑–¥–∞—Ç—å `internal/app/llm.go`**:
   - –ú–µ—Ç–æ–¥ `buildAnalysisPrompt(inputText string, referenceResults []*chromem.QueryResult) string`
     - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞: "Analyzed text" + "Reference sections" + "Task"
   - –ú–µ—Ç–æ–¥ `queryOllama(ctx context.Context, prompt string) (string, error)`
     - HTTP POST –∑–∞–ø—Ä–æ—Å –∫ `/api/generate`
     - –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞

2. **–û–±–Ω–æ–≤–∏—Ç—å `internal/app/run.go`**:
   - –ü–æ—Å–ª–µ –ø–æ–∏—Å–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Å–µ–∫—Ü–∏–π: —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç
   - –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ LLM —á–µ—Ä–µ–∑ `queryOllama()`
   - –í—ã–≤–æ–¥–∏—Ç—å –∞–Ω–∞–ª–∏–∑ –æ—Ç LLM

**–ü—Ä–æ–º–ø—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**:
```
You are a document comparison expert.

Analyzed text:
<<<
<–≤—Ö–æ–¥—è—â–∞—è —Å—Ç—Ä–æ–∫–∞>
>>>

Reference sections:
<<<
[Section 1: ...]
<—Ç–µ–∫—Å—Ç —Å–µ–∫—Ü–∏–∏ 1>
---
[Section 2: ...]
<—Ç–µ–∫—Å—Ç —Å–µ–∫—Ü–∏–∏ 2>
>>>

Task:
1. Compare the analyzed text with reference sections
2. Identify contradictions or inconsistencies
3. Highlight potential issues or risks
4. Provide specific recommendations
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ–ª—É—á–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –æ—Ç LLM —Å –≤—ã–≤–æ–¥–æ–º –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```bash
# –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ Ollama –∑–∞–ø—É—â–µ–Ω–∞
ollama serve

# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
ollama pull gemma3:12b
ollama pull nomic-embed-text

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
go run cmd/console_rag/main.go --reference-doc=test.md

> –†–∞–±–æ—Ç–Ω–∏–∫ –º–æ–∂–µ—Ç –Ω–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è
# ü§ñ Analyzing with LLM...
# 
# LLM Analysis:
# ‚ö†Ô∏è CONTRADICTION DETECTED
# The analyzed text contradicts Article 21 of the Labor Code...
# Recommendations: ...
```

---

## –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
console_rag/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ console_rag/
‚îÇ       ‚îî‚îÄ‚îÄ main.go           # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, —Ñ–ª–∞–≥–∏, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config.go         # ReferenceDoc, ChunkSize, ChunkOverlap, etc.
‚îÇ   ‚îî‚îÄ‚îÄ app/
‚îÇ       ‚îú‚îÄ‚îÄ app.go            # Init(), –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
‚îÇ       ‚îú‚îÄ‚îÄ run.go            # –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π —Ü–∏–∫–ª, handleInput()
‚îÇ       ‚îú‚îÄ‚îÄ index.go          # fileGetContent(), extractPDFText()
‚îÇ       ‚îú‚îÄ‚îÄ chunker.go        # ChunkMarkdown(), ChunkText()
‚îÇ       ‚îî‚îÄ‚îÄ llm.go            # queryOllama(), buildAnalysisPrompt()
‚îú‚îÄ‚îÄ go.mod
‚îú‚îÄ‚îÄ go.sum
‚îî‚îÄ‚îÄ CONTEXT.md
```

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```go
require (
    github.com/caarlos0/env/v10 v10.0.0
    github.com/joho/godotenv v1.5.1
    github.com/philippgille/chromem-go v0.7.0
    github.com/yuin/goldmark v1.7.0
    github.com/ledongthuc/pdf v0.0.0-20220302013555-4b3e7f4e1e4e
)
```

## –ó–∞–ø—É—Å–∫

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
go mod tidy

# –ó–∞–ø—É—Å–∫ Ollama (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
ollama serve

# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π
ollama pull gemma3:12b
ollama pull nomic-embed-text

# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
go run cmd/console_rag/main.go --reference-doc=/path/to/reference.md

# –ò–ª–∏ —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —á–µ—Ä–µ–∑ env
OLLAMA_URL=http://localhost:11434 \
OLLAMA_MODEL=gemma3:12b \
OLLAMA_EMBED_MODEL=nomic-embed-text \
CHUNK_SIZE=1000 \
CHUNK_OVERLAP=200 \
go run cmd/console_rag/main.go --reference-doc=/path/to/reference.md

# –í–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
> –†–∞–±–æ—Ç–Ω–∏–∫ –æ–±—è–∑–∞–Ω —Å–æ–±–ª—é–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ä–∞—Å–ø–æ—Ä—è–¥–∫–∞
> –†–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–≤–æ–ª–∏—Ç—å —Ä–∞–±–æ—Ç–Ω–∏–∫–∞ –±–µ–∑ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –ø—Ä–∏—á–∏–Ω
> Ctrl+C –¥–ª—è –≤—ã—Ö–æ–¥–∞
```

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–¢–ö –†–§)

```bash
# –°–∫–∞—á–∞—Ç—å –¢–ö –†–§ –≤ Markdown
wget https://example.com/LaborCodexRus.md

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
go run cmd/console_rag/main.go --reference-doc=LaborCodexRus.md

# –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç—ã –∏–∑ –õ–ù–ê
> –†–∞–±–æ—Ç–Ω–∏–∫ –æ–±—è–∑–∞–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å –ª—é–±—ã–µ —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è
> –†–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ –∏–∑–º–µ–Ω—è—Ç—å —É—Å–ª–æ–≤–∏—è —Ç—Ä—É–¥–æ–≤–æ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞ –≤ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–º –ø–æ—Ä—è–¥–∫–µ
```

---

## –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–ë–î —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–º–µ–Ω–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞**: `<document_name>.gob` –≤–º–µ—Å—Ç–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ `vectordb.gob`
2. **–ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤–≤–æ–¥ = —Ç–µ–∫—Å—Ç**, –∞ –Ω–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º
3. **–ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤** - —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –æ—Å–Ω–æ–≤–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç + –≤—Ö–æ–¥—è—â–∏–µ —Å—Ç—Ä–æ–∫–∏
4. **–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞** - –Ω–µ—Ç —Å–ª–æ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤
5. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤** - –ë–î —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `ExportToFile`/`ImportFromFile`
